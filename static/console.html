<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Prolog console</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
   
    
    <!-- Le styles -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the bottom of the topbar */
      }
      #editor { 
		height: 800px;
/*		left: 600px;*/
		position: relative;
/*		right: 0;*/
/*		top: 100px;*/
		width: 800px;
      }
      #container_editor{
/*	  float: right;*/
	    display: none;
	    margin-left: 7em;
/*     margin-top: 100px; */
	    width: 800px;
      
      }
      #right_part{
	/*  float: left;
	  width: 600px;
	  margin-left:1em;*/
	  margin-top:2em;
	     margin-left: 7em;
	    width: 800px;
      
      }
      div.right{
	float:right
      }
      div.left{
	float:left
      }
      #trace{
	    width:800px;
	    display:none;
	    
/*	    float:right*/
      }
    </style>
    <link href="css/bootstrap-responsive.min.css" rel="stylesheet">
    <link href="css/my.css" rel="stylesheet">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="../assets/js/html5shiv.js"></script>
    <![endif]-->


  </head>

  <body onload="startRealtime()">
  <div class="container"  >
       <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container"  >
          <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
          </button>
          <a class="brand" href="#">PocketOracle</a>
          
          <div class="nav-collapse collapse" style='float:left' >
            <ul class="nav">
            <a class="btn btn-success pull-right greenbtn" href="/index.html">Queue</a>
            </ul>
          </div><!--/.nav-collapse -->
          
          <div class="nav-collapse collapse" style='float:right' >
            <ul class="nav">
            <a class="btn btn-success pull-right greenbtn" href="#"> Advanced </a>
	    </ul>
          </div>
          
          <div class="nav-collapse collapse" style='float:right' >
            <ul class="nav">
	    <a class="btn btn-success pull-right greenbtn" href="/dev_help.html"> API </a> 
	    </ul>
          </div>
	  
	  <div class="nav-collapse collapse" style='float:right' >
            <ul class="nav">
<!--            <span id="signinButton">-->
	 <!-- <span
	    class="g-signin"
	    data-callback="signinCallback"
	    data-clientid="768399903870.apps.googleusercontent.com"
	    data-cookiepolicy="single_host_origin"
	    data-requestvisibleactions="http://schemas.google.com/AddActivity"
	    data-scope="https://www.googleapis.com/auth/plus.login">
	  </span>
	</span>-->
	  <button class="btn btn-danger  pull-right greenbtn" id='authorizeButton' href="javascript:startRealtime()"> Sign in</button>
	    </ul>
          </div>
      
   
   
        </div>
      </div>
    </div>
        
        
        
        </div>
      </div>
    </div>

    <div class="container" id="container" style='border-bottom: 1px solid gray' >
	  <div  id='tabs' >
	        <a style='padding-left: 1em;' href="javascript:open_console()">Console</a>
	        <a id='create_new_project' style='padding-left: 1em;' href="javascript:create_new_project()">Create Project</a>

		<a id='online_ide_button' style='display:none;padding-left: 1em;' href="javascript:show_online()">Online IDE</a>
		<a style='padding-left: 1em;' href="javascript:help()">Help</a>

          </div>
     </div>    
      <div id='console' style='margin-left: 7em;  width:800px; display:none; margin-top: 2em; float:left'  >
		<div class="right"><!--<a  style='padding-left: 1em;' href="javascript:clear_console()">Clear</a>-->
				    <a  style='padding-left: 1em;' href="javascript:close_console1()">Close console</a></div>  
		<p>*Type 'help' for listing inner commands </p>
		
		<div id="msgs" style="font-size: 14px;padding:12px; height:300px;
				      width: 800px;border:1px solid black;
				       overflow: auto;
				      ">
		<p class='console_p'> Prolog 0.5 </p>
		
		
	      
			<div id="sse" >
			  <div style="float:left;font-size: 14px;">| - ?&nbsp;</div>
			    <div style="float:left">
			    <input id="code"  style="border:1px solid #0088CC;line-height:1.5em;
						      width:775px; height:20px;font-size:14px" 
				      onkeyup="listen(this,event)" />
			  </div> 
			  
			  
			</div>
			
		</div>
      </div>
      <div id='right_part' >
      <div id='trace'  >
      <h4>Trace :  </h4>
		<div id="trace_msg" style=" overflow: auto;font-size: 12px;height:200px; width: 800px;border:1px solid black;">
		
		
		
		    		<div id="trace_sse" >
				  <div style="float:left;font-size: 12px;">| - ?&nbsp;</div>
				  <div style="float:left">
				      <input id="trace_input" rows='3' style="border:1px solid #0088CC;
						      width:775px; height:20px; 
						      font-size:12px" 
						      onkeyup="listen_trace(this,event)" />
				  </div> 
			      </div>
		    
		    
		    
		    
		    
		</div>
      </div>

   
    </div> <!--right part-->
   
      <div id='container_help' > 
      
			  <div class="hero-unit">
			    <h4>Use prolog in your application</h4>
			    <p>This is a template for a simple marketing or informational website. It includes a large callout called the hero unit and three supporting pieces of content. Use it as a starting point to create something more unique.</p>
			</div>

			
      
      
      </div>

   
      <div id='container_editor' > 
      
			<h4> Editor  </h4><div class="right">
			<a  style='padding-left: 1em;' href="javascript:load_code()">Load Code</a>
			<a  style='padding-left: 1em;' id='filePicker' href="javascript:save_file()">Save</a>
      			<a  style='padding-left: 1em;' id='filePicker' href="javascript:choose_drive()">GoogleDoc</a>
      			<a  style='padding-left: 1em;' href="javascript:close_editor()">Close editor</a> 

      			</div> 

			<div id='editor'></div>
			
      
      
      </div>

   
    </div>

    <!-- /container -->

    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="js/jquery1.9.1.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="http://www.google.com/jsapi?key=AIzaSyCSqtP-qt1uondUTZu2JVIrgKeU4qxgOzs"></script>
    <script type="text/javascript" src="https://apis.google.com/js/api.js"></script>
    <script type="text/javascript" src="js/realtime-client-utils.js"></script>
    <script type="text/javascript" src="js/client_ide.js"></script>
    <script type="text/javascript" src="js/samples.js"></script>

    <script src="js/ace.js" type="text/javascript" charset="utf-8"></script>
<script>
      $(document).ready(function() {
    
	
	Key = Math.random();
	// Handler for .ready() called.
	
	ws = new WebSocket(WHOST+Key);
	ws.onopen = function() {
	    console.log('Connected');
	};
	ws.onmessage = function (evt)
	{
	    var received_msg = evt.data;
	    console.log("Received: " + received_msg);
	    var obj =  document.getElementById('msgs');
	    
// 	    $("<p>| -? " + received_msg +"</p>").appendTo("#msgs");
	    var patt=/looking next \?/;
	    var result=patt.test(received_msg);
	    if(result){
		wait_answer = 1;
	    }

	    $("<p>| -? " + received_msg +"</p>").insertBefore("#sse");	    

	    $("#trace_input").prop("disabled", true);
    	    $("#code").prop("disabled", false);
	    $("#code").focus();
// 	    $("#sse").animate({ scrollTop: $("#sse").height() }, "slow");
	    scroll_console();
	    
	    // 	    obj.scrollTo(0, obj.scrollHeight);
	    
	};
	ws.onclose = function()
	{
	    console.log('Connection closed');
	};

	
	ws_trace = new WebSocket(WHOST+"trace/" + Key);
	ws_trace.onopen = function() {
	    console.log('Connected');
	};
	ws_trace.onmessage = function (evt)
	{
	    var received_msg = evt.data;
	    console.log("Received: " + received_msg);
	    if(received_msg !="finish"){
	    
		$("#trace_input").prop("disabled", false);
		$("#trace_input").focus();    
	        $("<p>| -? " + received_msg +"</p>").insertBefore("#trace_sse");	    
	        scroll_trace();

	    }
	    

	};
	ws_trace.onclose = function()
	{
	    console.log('Connection closed');
	};
	editor = ace.edit("editor");
	var Path = readCookie(CookieName);
	if(Path){
	    PARENT_DIRECTORY = Path;
	    show("online_ide_button");
	    hide("create_new_project");
	 }   
	      
    

    });
    //
    
	
    /**
     * Options for the Realtime loader.
     */
      google.load('picker', '1');      
	
	
      var realtimeOptions = {
      /**
       * Client ID from the APIs Console.
       */
      clientId: '768399903870.apps.googleusercontent.com',

      /**
       * The ID of the button to click to authorize. Must be a DOM element ID.
       */
      authButtonElementId: 'authorizeButton',

      /**
       * Function to be called when a Realtime model is first created.
       */
      initializeModel: initializeModel,

      /**
       * Autocreate files right after auth automatically.
       */
      autoCreate: false,

      /**
       * Autocreate files right after auth automatically.
       */
       defaultTitle: "New  Prolog Code",

      /**
       * Function to be called every time a Realtime file is loaded.
       */
      onFileLoaded: onFileLoaded
    };
 
    
    /**
     * Start the Realtime loader with the options.
     */
     
    function startRealtime() {
      realtimeLoader = new rtclient.RealtimeLoader(realtimeOptions);
      realtimeLoader.start(my_after_auth);
    }

	
	
</script>
<!--<script type="text/javascript">
      (function() {
       var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
       po.src = 'https://apis.google.com/js/client:plusone.js';
       var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
     })();
    </script>-->
</body>
</html>
